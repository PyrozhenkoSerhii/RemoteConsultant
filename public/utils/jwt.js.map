{"version":3,"sources":["../../server/utils/jwt.js"],"names":["exports","sign","user","logger","info","username","jwt","toJSON","config","api","secret","expiresIn","verify","token","err","decoded","warn","JSON","stringify","name"],"mappings":";;AAAA;;AACA;;AACA;;;;AACA;AAGAA,OAAO,CAACC,IAAR,GAAe,UAAAC,IAAI,EAAI;AACnBC,kBAAOC,IAAP,uBAA2BF,IAAI,CAACG,QAAhC;;AAEA,SAAOC,sBAAIL,IAAJ,CACHC,IAAI,CAACK,MAAL,EADG,EAEHC,gBAAOC,GAAP,CAAWC,MAFR,EAGH;AACIC,IAAAA,SAAS,EAAE;AADf,GAHG,CAAP;AAMH,CATD;;AAYAX,OAAO,CAACY,MAAR,GAAiB,UAAAC,KAAK,EAAI;AACtBP,wBAAIM,MAAJ,CAAWC,KAAX,EAAkBL,gBAAOE,MAAzB,EAAiC,UAACI,GAAD,EAAMC,OAAN,EAAkB;AAC/C,QAAID,GAAJ,EAAS;AACLX,sBAAOa,IAAP,yCAA6CC,IAAI,CAACC,SAAL,CAAeJ,GAAG,CAACK,IAAnB,CAA7C;;AACA,aAAO,KAAP;AACH;;AAED,QAAIJ,OAAJ,EAAa;AACTZ,sBAAOC,IAAP;;AACA,aAAO,IAAP;AACH;AACJ,GAVD;AAWH,CAZD","sourcesContent":["import jwt from 'jsonwebtoken'\r\nimport config from '../config'\r\nimport logger from './logger'\r\n// import blacklist from 'express-jwt-blacklist'\r\n\r\n\r\nexports.sign = user => {\r\n    logger.info(`[JWT] User -${user.username}- was signed`)\r\n\r\n    return jwt.sign(\r\n        user.toJSON(),\r\n        config.api.secret,\r\n        {\r\n            expiresIn: '24h'\r\n        })\r\n}\r\n\r\n\r\nexports.verify = token => {\r\n    jwt.verify(token, config.secret, (err, decoded) => {\r\n        if (err) {\r\n            logger.warn(`[JWT] Token isn't valid, err: ${JSON.stringify(err.name)}`)\r\n            return false\r\n        }\r\n\r\n        if (decoded) {\r\n            logger.info(`[JWT] Token was verified`)\r\n            return true\r\n        }\r\n    })\r\n}\r\n"],"file":"jwt.js"}